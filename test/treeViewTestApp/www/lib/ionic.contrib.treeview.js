angular.module('ionic.contrib.TreeView', ['ionic']).directive("treeView", [
  "$animate", "$compile", "$timeout", function($animate, $compile, $timeout) {
    return {
      restrict: "E",
      require: ["^?$ionicScroll"],
      template: "<tree-item ng-style=\"{width: fullWidth}\" collection-item-width=\"'100%'\" collection-item-height=\"itemHeight\" collection-repeat=\"row in treeRows | filter:filterExpanded() track by row.id\" row=\"row\">{{row.name}}</tree-item>",
      scope: {
        onExpandChange: '&',
        onCheckboxChange: '&',
        onClick: '&',
        items: '=',
        showCheckboxes: '=',
        showNumbers: '=',
        fetchData: '=',
        hasMoreData: '=',
        itemHeight: '='
      },
      compile: function($element, $attr) {
        var infiniteScroll, listEl;
        listEl = angular.element("<div class=\"tree-view list\">").append($element.contents());
        infiniteScroll = angular.element("<ion-infinite-scroll ng-if=\"hasMoreData()\" on-infinite=\"fetchData()\" distance=\"1%\">");
        $element.append(listEl).append(infiniteScroll);
        return function($scope, $element, $attrs, ctrls) {
          var buildTreeRows, init, treeRows;
          treeRows = [];
          $scope.fullWidth = '100%';
          $scope.filterExpanded = function() {
            return function(row) {
              return row.$treeview.visible === true;
            };
          };
          buildTreeRows = function(items, level, number, visible) {
            var childrenVisible, index, item, rowNumber, _i, _len, _ref, _results;
            if ($attrs.scrollHeight) {
              if ((_ref = $element.parent()[0]) != null) {
                _ref.style.height = $attrs.scrollHeight;
              }
            }
            if (!number) {
              number = [];
            }
            _results = [];
            for (index = _i = 0, _len = items.length; _i < _len; index = ++_i) {
              item = items[index];
              rowNumber = number.slice();
              rowNumber.push(index + 1);
              if (!item.$treeview) {
                item.$treeview = {};
              }
              item.$treeview.level = level;
              item.$treeview.number = rowNumber;
              if (item.$treeview.showCheckbox === void 0) {
                item.$treeview.showCheckbox = null;
              }
              item.$treeview.visible = item.visible === false ? false : visible;
              if (item.$treeview.checked === void 0) {
                item.$treeview.checked = false;
              }
              item.$treeview.hideExpander = item.hideExpander !== void 0 ? item.hideExpander : false;
              if (item.expanded === void 0) {
                item.expanded = false;
              }
              treeRows.push(item);
              childrenVisible = visible && item.expanded;
              if (item.children) {
                _results.push(buildTreeRows(item.children, level + 1, rowNumber, childrenVisible));
              } else {
                _results.push(void 0);
              }
            }
            return _results;
          };
          init = function() {
            treeRows = [];
            buildTreeRows($scope.items, 0, null, true);
            return $scope.treeRows = treeRows;
          };
          $scope.$watch('items', init, true);
        };
      }
    };
  }
]);

angular.module('ionic.contrib.TreeView').controller("$treeView", ["$scope", "$attrs", "$parse", function($scope, $attrs, $parse) {}]);

var TreeView;

TreeView = ionic.views.View.inherit({
  initialize: function(opts) {
    var _this;
    return;
    _this = this;
    opts = ionic.extend({
      onReorder: function(el, oldIndex, newIndex) {},
      virtualRemoveThreshold: -200,
      virtualAddThreshold: 200,
      canSwipe: function() {
        return true;
      }
    }, opts);
    ionic.extend(this, opts);
    if (!this.itemHeight && this.listEl) {
      this.itemHeight = this.listEl.children[0] && parseInt(this.listEl.children[0].style.height, 10);
    }
    this.onRefresh = opts.onRefresh || function() {};
    this.onRefreshOpening = opts.onRefreshOpening || function() {};
    this.onRefreshHolding = opts.onRefreshHolding || function() {};
    window.ionic.onGesture("release", (function(e) {
      _this._handleEndDrag(e);
    }), this.el);
    window.ionic.onGesture("drag", (function(e) {
      _this._handleDrag(e);
    }), this.el);
    this._initDrag();
  },

  /**
  Called to tell the list to stop refreshing. This is useful
  if you are refreshing the list and are done with refreshing.
   */
  stopRefreshing: function() {
    var refresher;
    refresher = this.el.querySelector(".list-refresher");
    refresher.style.height = "0px";
  },

  /**
  If we scrolled and have virtual mode enabled, compute the window
  of active elements in order to figure out the viewport to render.
   */
  didScroll: function(e) {
    var first, highWater, itemHeight, itemsPerViewport, last, lowWater, nodes, scrollHeight, scrollTop, totalItems, viewportHeight;
    if (this.isVirtual) {
      itemHeight = this.itemHeight;
      totalItems = this.listEl.children.length;
      scrollHeight = e.target.scrollHeight;
      viewportHeight = this.el.parentNode.offsetHeight;
      scrollTop = e.scrollTop;
      highWater = Math.max(0, e.scrollTop + this.virtualRemoveThreshold);
      lowWater = Math.min(scrollHeight, Math.abs(e.scrollTop) + viewportHeight + this.virtualAddThreshold);
      itemsPerViewport = Math.floor((lowWater - highWater) / itemHeight);
      first = parseInt(Math.abs(highWater / itemHeight), 10);
      last = parseInt(Math.abs(lowWater / itemHeight), 10);
      this._virtualItemsToRemove = Array.prototype.slice.call(this.listEl.children, 0, first);
      nodes = Array.prototype.slice.call(this.listEl.children, first, first + itemsPerViewport);
      this.renderViewport && this.renderViewport(highWater, lowWater, first, last);
    }
  },
  didStopScrolling: function(e) {
    var el, i;
    if (this.isVirtual) {
      i = 0;
      while (i < this._virtualItemsToRemove.length) {
        el = this._virtualItemsToRemove[i];
        this.didHideItem && this.didHideItem(i);
        i++;
      }
    }
  },

  /**
  Clear any active drag effects on the list.
   */
  clearDragEffects: function() {
    if (this._lastDragOp) {
      this._lastDragOp.clean && this._lastDragOp.clean();
      this._lastDragOp = null;
    }
  },
  _initDrag: function() {
    this._lastDragOp = this._dragOp;
    this._dragOp = null;
  },
  _getItem: function(target) {
    while (target) {
      if (target.classList && target.classList.contains(ITEM_CLASS)) {
        return target;
      }
      target = target.parentNode;
    }
    return null;
  },
  _startDrag: function(e) {
    var didStart, item, lastDragOp, _this;
    _this = this;
    didStart = false;
    this._isDragging = false;
    lastDragOp = this._lastDragOp;
    item = void 0;
    if (ionic.DomUtil.getParentOrSelfWithClass(e.target, ITEM_REORDER_BTN_CLASS) && (e.gesture.direction === "up" || e.gesture.direction === "down")) {
      item = this._getItem(e.target);
      if (item) {
        this._dragOp = new ReorderDrag({
          listEl: this.el,
          el: item,
          scrollEl: this.scrollEl,
          scrollView: this.scrollView,
          onReorder: function(el, start, end) {
            _this.onReorder && _this.onReorder(el, start, end);
          }
        });
        this._dragOp.start(e);
        e.preventDefault();
      }
    } else if (!this._didDragUpOrDown && (e.gesture.direction === "left" || e.gesture.direction === "right") && Math.abs(e.gesture.deltaX) > 5) {
      item = this._getItem(e.target);
      if (item && item.querySelector(".item-options")) {
        this._dragOp = new SlideDrag({
          el: this.el,
          canSwipe: this.canSwipe
        });
        this._dragOp.start(e);
        e.preventDefault();
      }
    }
    if (lastDragOp && this._dragOp && !this._dragOp.isSameItem(lastDragOp) && e.defaultPrevented) {
      lastDragOp.clean && lastDragOp.clean();
    }
  },
  _handleEndDrag: function(e) {
    var _this;
    _this = this;
    this._didDragUpOrDown = false;
    if (!this._dragOp) {
      return;
    }
    this._dragOp.end(e, function() {
      _this._initDrag();
    });
  },

  /**
  Process the drag event to move the item to the left or right.
   */
  _handleDrag: function(e) {
    var buttons, content, _this;
    _this = this;
    content = void 0;
    buttons = void 0;
    if (Math.abs(e.gesture.deltaY) > 5) {
      this._didDragUpOrDown = true;
    }
    if (!this.isDragging && !this._dragOp) {
      this._startDrag(e);
    }
    if (!this._dragOp) {
      return;
    }
    e.gesture.srcEvent.preventDefault();
    this._dragOp.drag(e);
  }
});

angular.module('ionic.contrib.TreeView').directive("treeItem", [
  "$animate", "$compile", function($animate, $compile) {
    return {
      restrict: "E",
      controller: [
        "$scope", "$element", function($scope, $element) {
          $scope.toggle = function($event, row) {
            $event.stopPropagation();
            row.expanded = !row.expanded;
            return $scope.onExpandChange({
              row: row
            });
          };
          $scope.checkboxClick = function($event, row) {
            $event.stopPropagation();
            row.$treeview.checked = !row.$treeview.checked;
            return $scope.onCheckboxChange({
              row: row
            });
          };
          return $scope.rowClick = function(row) {
            return $scope.onClick({
              row: row
            });
          };
        }
      ],
      compile: function($element, $attrs) {
        var link;
        $element.addClass("item item-complex tree-item");
        link = function($scope, $element, $attrs) {
          var checkbox, chevron, containerLink, number, textContainer;
          $scope.getTreePadding = function(row) {
            var padding;
            padding = row.$treeview.level * 20;
            return {
              'padding-left': padding + 'px'
            };
          };
          $scope.getVisibility = function(row) {
            var _ref;
            if (row.$treeview.hideExpander) {
              return 'hidden';
            } else {
              if (((_ref = row.children) != null ? _ref.length : void 0) > 0) {
                return 'visible';
              } else {
                return 'hidden';
              }
            }
          };
          number = angular.element("<span ng-if=\"showNumbers\" class=\"tree-item-number\">{{row.$treeview.number.join('.')}}:</span>");
          checkbox = angular.element("<label ng-if=\"!(row.$treeview.showCheckbox || (showCheckboxes && row.$treeview.showCheckbox !== false))\" style=\"height: 28px; width: 1px; float: left; padding-left: 3px;\"></label> <label ng-if=\"row.$treeview.showCheckbox || (showCheckboxes && row.$treeview.showCheckbox !== false)\" class=\"checkbox\"><input type=\"checkbox\" ng-checked=\"row.$treeview.checked\" ng-click=\"checkboxClick($event, row)\"> </label>");
          containerLink = angular.element("<a class=\"item-content item-icon-right\" ng-class=\"{'tree-item-with-number': showNumbers, 'tree-item-with-checkbox': true}\" ng-click=\"rowClick(row)\" ng-style=\"getTreePadding(row)\" ></a>");
          chevron = angular.element("<a class=\"expand-button icon ion-chevron-down\" ng-class=\"{'tree-item-expanded': row.expanded}\" ng-style=\"{'visibility': getVisibility(row)}\" ng-click=\"toggle($event, row)\"></a>");
          textContainer = angular.element("<span class=\"tree-item-text\"></span>");
          textContainer.append($element.contents());
          containerLink.append(number);
          containerLink.append(checkbox);
          containerLink.append(textContainer).append(chevron);
          $element.append(containerLink);
          $compile(containerLink)($scope);
        };
        return link;
      }
    };
  }
]);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRyZWVfdmlld19kaXJlY3RpdmUuY29mZmVlIiwidHJlZV92aWV3X2NvbnRyb2xsZXIuY29mZmVlIiwidHJlZV92aWV3X3ZpZXcuY29mZmVlIiwidHJlZV9pdGVtX2RpcmVjdGl2ZS5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxDQUFDLE1BQVIsQ0FBZSx3QkFBZixFQUF5QyxDQUFDLE9BQUQsQ0FBekMsQ0FDQSxDQUFDLFNBREQsQ0FDVyxVQURYLEVBQ3VCO0VBQ3JCLFVBRHFCLEVBRXJCLFVBRnFCLEVBR3JCLFVBSHFCLEVBSXJCLFNBQUMsUUFBRCxFQUFXLFFBQVgsRUFBcUIsUUFBckIsR0FBQTtBQUNFLFdBQ0U7QUFBQSxNQUFBLFFBQUEsRUFBVSxHQUFWO0FBQUEsTUFDQSxPQUFBLEVBQVMsQ0FDUCxnQkFETyxDQURUO0FBQUEsTUFLQSxRQUFBLEVBQVUsd09BTFY7QUFBQSxNQVNBLEtBQUEsRUFDRTtBQUFBLFFBQUEsY0FBQSxFQUFnQixHQUFoQjtBQUFBLFFBQ0EsZ0JBQUEsRUFBa0IsR0FEbEI7QUFBQSxRQUVBLE9BQUEsRUFBUyxHQUZUO0FBQUEsUUFHQSxLQUFBLEVBQU8sR0FIUDtBQUFBLFFBSUEsY0FBQSxFQUFnQixHQUpoQjtBQUFBLFFBS0EsV0FBQSxFQUFhLEdBTGI7QUFBQSxRQU1BLFNBQUEsRUFBVyxHQU5YO0FBQUEsUUFPQSxXQUFBLEVBQWEsR0FQYjtBQUFBLFFBUUEsVUFBQSxFQUFZLEdBUlo7T0FWRjtBQUFBLE1BbUJBLE9BQUEsRUFBUyxTQUFDLFFBQUQsRUFBVyxLQUFYLEdBQUE7QUFDUCxZQUFBLHNCQUFBO0FBQUEsUUFBQSxNQUFBLEdBQVMsT0FBTyxDQUFDLE9BQVIsQ0FBZ0IsZ0NBQWhCLENBQWlELENBQUMsTUFBbEQsQ0FBeUQsUUFBUSxDQUFDLFFBQVQsQ0FBQSxDQUF6RCxDQUFULENBQUE7QUFBQSxRQUNBLGNBQUEsR0FBaUIsT0FBTyxDQUFDLE9BQVIsQ0FBZ0IsMkZBQWhCLENBRGpC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VUFERjtlQUFBLE1BQUE7dUJBR0UsU0FIRjtlQUhGO2FBRHFCO1VBQUEsQ0FKdkIsQ0FBQTtBQUFBLFVBZUEsTUFBQSxHQUFTLE9BQU8sQ0FBQyxPQUFSLENBQWdCLG1HQUFoQixDQWZULENBQUE7QUFBQSxVQTJCQSxRQUFBLEdBQVcsT0FBTyxDQUFDLE9BQVIsQ0FBZ0Isb2FBQWhCLENBM0JYLENBQUE7QUFBQSxVQXdDQSxhQUFBLEdBQWdCLE9BQU8sQ0FBQyxPQUFSLENBQWdCLGtNQUFoQixDQXhDaEIsQ0FBQTtBQUFBLFVBK0NBLE9BQUEsR0FBVSxPQUFPLENBQUMsT0FBUixDQUFnQiwwTEFBaEIsQ0EvQ1YsQ0FBQTtBQUFBLFVBb0RBLGFBQUEsR0FBZ0IsT0FBTyxDQUFDLE9BQVIsQ0FBZ0Isd0NBQWhCLENBcERoQixDQUFBO0FBQUEsVUFzREEsYUFBYSxDQUFDLE1BQWQsQ0FBcUIsUUFBUSxDQUFDLFFBQVQsQ0FBQSxDQUFyQixDQXREQSxDQUFBO0FBQUEsVUF5REEsYUFBYSxDQUFDLE1BQWQsQ0FBcUIsTUFBckIsQ0F6REEsQ0FBQTtBQUFBLFVBMkRBLGFBQWEsQ0FBQyxNQUFkLENBQXFCLFFBQXJCLENBM0RBLENBQUE7QUFBQSxVQTZEQSxhQUFhLENBQUMsTUFBZCxDQUFxQixhQUFyQixDQUFtQyxDQUFDLE1BQXBDLENBQTJDLE9BQTNDLENBN0RBLENBQUE7QUFBQSxVQStEQSxRQUFRLENBQUMsTUFBVCxDQUFnQixhQUFoQixDQS9EQSxDQUFBO0FBQUEsVUFnRUEsUUFBQSxDQUFTLGFBQVQsQ0FBQSxDQUF3QixNQUF4QixDQWhFQSxDQURLO1FBQUEsQ0FGUCxDQUFBO0FBdUVBLGVBQU8sSUFBUCxDQXhFTztNQUFBLENBbEJUO0tBREYsQ0FERjtFQUFBLENBSDZEO0NBQS9ELENBQUEsQ0FBQSIsImZpbGUiOiJpb25pYy5jb250cmliLnRyZWV2aWV3LmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2lvbmljLmNvbnRyaWIuVHJlZVZpZXcnLCBbJ2lvbmljJ10pXG4uZGlyZWN0aXZlIFwidHJlZVZpZXdcIiwgW1xuICBcIiRhbmltYXRlXCJcbiAgXCIkY29tcGlsZVwiXG4gIFwiJHRpbWVvdXRcIlxuICAoJGFuaW1hdGUsICRjb21waWxlLCAkdGltZW91dCkgLT5cbiAgICByZXR1cm4gKFxuICAgICAgcmVzdHJpY3Q6IFwiRVwiXG4gICAgICByZXF1aXJlOiBbXG4gICAgICAgIFwiXj8kaW9uaWNTY3JvbGxcIlxuICAgICAgXVxuICAgICAgI2NvbnRyb2xsZXI6IFwiJHRyZWVWaWV3XCJcbiAgICAgIHRlbXBsYXRlOiBcIjx0cmVlLWl0ZW0gbmctc3R5bGU9XFxcInt3aWR0aDogZnVsbFdpZHRofVxcXCIgXG4gICAgICAgIGNvbGxlY3Rpb24taXRlbS13aWR0aD1cXFwiJzEwMCUnXFxcIiBjb2xsZWN0aW9uLWl0ZW0taGVpZ2h0PVxcXCJpdGVtSGVpZ2h0XFxcIiBcbiAgICAgICAgY29sbGVjdGlvbi1yZXBlYXQ9XFxcInJvdyBpbiB0cmVlUm93cyB8IGZpbHRlcjpmaWx0ZXJFeHBhbmRlZCgpIHRyYWNrIGJ5IHJvdy5pZFxcXCIgXG4gICAgICAgIHJvdz1cXFwicm93XFxcIj57e3Jvdy5uYW1lfX08L3RyZWUtaXRlbT5cIixcbiAgICAgIHNjb3BlOiBcbiAgICAgICAgb25FeHBhbmRDaGFuZ2U6ICcmJ1xuICAgICAgICBvbkNoZWNrYm94Q2hhbmdlOiAnJidcbiAgICAgICAgb25DbGljazogJyYnXG4gICAgICAgIGl0ZW1zOiAnPSdcbiAgICAgICAgc2hvd0NoZWNrYm94ZXM6ICc9J1xuICAgICAgICBzaG93TnVtYmVyczogJz0nXG4gICAgICAgIGZldGNoRGF0YTogJz0nLFxuICAgICAgICBoYXNNb3JlRGF0YTogJz0nLFxuICAgICAgICBpdGVtSGVpZ2h0OiAnPSdcbiAgICAgIGNvbXBpbGU6ICgkZWxlbWVudCwgJGF0dHIpIC0+XG4gICAgICAgIGxpc3RFbCA9IGFuZ3VsYXIuZWxlbWVudChcIjxkaXYgY2xhc3M9XFxcInRyZWUtdmlldyBsaXN0XFxcIj5cIikuYXBwZW5kKCRlbGVtZW50LmNvbnRlbnRzKCkpXG4gICAgICAgIGluZmluaXRlU2Nyb2xsID0gYW5ndWxhci5lbGVtZW50KFwiPGlvbi1pbmZpbml0ZS1zY3JvbGwgbmctaWY9XFxcImhhc01vcmVEYXRhKClcXFwiIG9uLWluZmluaXRlPVxcXCJmZXRjaERhdGEoKVxcXCIgZGlzdGFuY2U9XFxcIjElXFxcIj5cIilcbiAgICAgICAgJGVsZW1lbnQuYXBwZW5kKGxpc3RFbCkuYXBwZW5kKGluZmluaXRlU2Nyb2xsKTtcbiAgICAgICAgXG4gICAgICAgICgkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsIGN0cmxzKSAtPlxuICAgICAgICAgIHRyZWVSb3dzID0gW11cbiAgICAgICAgICAkc2NvcGUuZnVsbFdpZHRoID0gJzEwMCUnO1xuXG4gICAgICAgICAgJHNjb3BlLmZpbHRlckV4cGFuZGVkID0gLT5cbiAgICAgICAgICAgIChyb3cpIC0+IHJvdy4kdHJlZXZpZXcudmlzaWJsZSBpcyB0cnVlXG4gICAgICAgICAgXG4gICAgICAgICAgYnVpbGRUcmVlUm93cyA9IChpdGVtcywgbGV2ZWwsIG51bWJlciwgdmlzaWJsZSkgLT5cbiAgICAgICAgICAgICMgc2V0IGN1c3RvbSBcbiAgICAgICAgICAgIGlmICRhdHRycy5zY3JvbGxIZWlnaHRcbiAgICAgICAgICAgICAgJGVsZW1lbnQucGFyZW50KClbMF0/LnN0eWxlLmhlaWdodCA9ICRhdHRycy5zY3JvbGxIZWlnaHQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG51bWJlciA9IFtdIHVubGVzcyBudW1iZXJcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZm9yIGl0ZW0sIGluZGV4IGluIGl0ZW1zXG4gICAgICAgICAgICAgIHJvd051bWJlciA9IG51bWJlci5zbGljZSgpXG4gICAgICAgICAgICAgIHJvd051bWJlci5wdXNoIGluZGV4ICsgMVxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgIyBBbGxvdyBwcmVkZWZpbmluZyBzb21lIGNvbmZpZyBvcHRpb24gZnJvbSBvdXRzaWRlIHRoaXMgZGlyZWN0aXZlLlxuICAgICAgICAgICAgICBpdGVtLiR0cmVldmlldyA9IHt9IHVubGVzcyBpdGVtLiR0cmVldmlld1xuXG4gICAgICAgICAgICAgICMgTm9uLWN1c3RvbWl6YWJsZSBjb25maWcgb3B0aW9uc1xuICAgICAgICAgICAgICBpdGVtLiR0cmVldmlldy5sZXZlbCA9IGxldmVsXG4gICAgICAgICAgICAgIGl0ZW0uJHRyZWV2aWV3Lm51bWJlciA9IHJvd051bWJlclxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgIyBDdXN0b21pemFibGUgY29uZmlnIG9wdGlvblxuICAgICAgICAgICAgICBpdGVtLiR0cmVldmlldy5zaG93Q2hlY2tib3ggPSBudWxsIGlmIGl0ZW0uJHRyZWV2aWV3LnNob3dDaGVja2JveCBpcyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgaXRlbS4kdHJlZXZpZXcudmlzaWJsZSA9IGlmIGl0ZW0udmlzaWJsZSBpcyBmYWxzZSB0aGVuIGZhbHNlIGVsc2UgdmlzaWJsZVxuICAgICAgICAgICAgICBpdGVtLiR0cmVldmlldy5jaGVja2VkID0gZmFsc2UgaWYgaXRlbS4kdHJlZXZpZXcuY2hlY2tlZCBpcyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgaXRlbS4kdHJlZXZpZXcuaGlkZUV4cGFuZGVyID0gaWYgaXRlbS5oaWRlRXhwYW5kZXIgaXNudCB1bmRlZmluZWQgdGhlbiBpdGVtLmhpZGVFeHBhbmRlciBlbHNlIGZhbHNlXG4gICAgICAgICAgICAgIGl0ZW0uZXhwYW5kZWQgPSBmYWxzZSBpZiBpdGVtLmV4cGFuZGVkIGlzIHVuZGVmaW5lZFxuXG4gICAgICAgICAgICAgIHRyZWVSb3dzLnB1c2ggaXRlbVxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgY2hpbGRyZW5WaXNpYmxlID0gdmlzaWJsZSBhbmQgaXRlbS5leHBhbmRlZFxuICAgICAgICAgICAgICBidWlsZFRyZWVSb3dzIGl0ZW0uY2hpbGRyZW4sIGxldmVsICsgMSwgcm93TnVtYmVyLCBjaGlsZHJlblZpc2libGUgaWYgaXRlbS5jaGlsZHJlblxuXG4gICAgICAgICAgaW5pdCA9IC0+XG4gICAgICAgICAgICAjY29uc29sZS5sb2cgJ1JFQlVJTEQnXG4gICAgICAgICAgICB0cmVlUm93cyA9IFtdXG4gICAgICAgICAgICBidWlsZFRyZWVSb3dzICRzY29wZS5pdGVtcywgMCwgbnVsbCwgdHJ1ZVxuICAgICAgICAgICAgJHNjb3BlLnRyZWVSb3dzID0gdHJlZVJvd3NcblxuICAgICAgICAgICRzY29wZS4kd2F0Y2ggJ2l0ZW1zJywgaW5pdCwgdHJ1ZVxuXG4gICAgICAgICAgcmV0dXJuXG4gICAgKVxuXSIsImFuZ3VsYXIubW9kdWxlKCdpb25pYy5jb250cmliLlRyZWVWaWV3Jylcbi5jb250cm9sbGVyIFwiJHRyZWVWaWV3XCIsIFtcbiAgXCIkc2NvcGVcIlxuICBcIiRhdHRyc1wiXG4gIFwiJHBhcnNlXCJcbiAgKCRzY29wZSwgJGF0dHJzLCAkcGFyc2UpIC0+XG4gICAgXG4gICAgcmV0dXJuXG5dIiwiVHJlZVZpZXcgPSBpb25pYy52aWV3cy5WaWV3LmluaGVyaXQoXG4gIGluaXRpYWxpemU6IChvcHRzKSAtPlxuICAgIHJldHVyblxuXG4gICAgX3RoaXMgPSB0aGlzXG4gICAgb3B0cyA9IGlvbmljLmV4dGVuZChcbiAgICAgIG9uUmVvcmRlcjogKGVsLCBvbGRJbmRleCwgbmV3SW5kZXgpIC0+XG5cbiAgICAgIHZpcnR1YWxSZW1vdmVUaHJlc2hvbGQ6IC0yMDBcbiAgICAgIHZpcnR1YWxBZGRUaHJlc2hvbGQ6IDIwMFxuICAgICAgY2FuU3dpcGU6IC0+XG4gICAgICAgIHRydWVcbiAgICAsIG9wdHMpXG4gICAgaW9uaWMuZXh0ZW5kIHRoaXMsIG9wdHNcbiAgICBAaXRlbUhlaWdodCA9IEBsaXN0RWwuY2hpbGRyZW5bMF0gYW5kIHBhcnNlSW50KEBsaXN0RWwuY2hpbGRyZW5bMF0uc3R5bGUuaGVpZ2h0LCAxMCkgIGlmIG5vdCBAaXRlbUhlaWdodCBhbmQgQGxpc3RFbFxuICAgIFxuICAgICNpb25pYy52aWV3cy5MaXN0Vmlldy5fX3N1cGVyX18uaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIG9wdHMpO1xuICAgIEBvblJlZnJlc2ggPSBvcHRzLm9uUmVmcmVzaCBvciAtPlxuXG4gICAgQG9uUmVmcmVzaE9wZW5pbmcgPSBvcHRzLm9uUmVmcmVzaE9wZW5pbmcgb3IgLT5cblxuICAgIEBvblJlZnJlc2hIb2xkaW5nID0gb3B0cy5vblJlZnJlc2hIb2xkaW5nIG9yIC0+XG5cbiAgICB3aW5kb3cuaW9uaWMub25HZXN0dXJlIFwicmVsZWFzZVwiLCAoKGUpIC0+XG4gICAgICBfdGhpcy5faGFuZGxlRW5kRHJhZyBlXG4gICAgICByZXR1cm5cbiAgICApLCBAZWxcbiAgICB3aW5kb3cuaW9uaWMub25HZXN0dXJlIFwiZHJhZ1wiLCAoKGUpIC0+XG4gICAgICBfdGhpcy5faGFuZGxlRHJhZyBlXG4gICAgICByZXR1cm5cbiAgICApLCBAZWxcbiAgICBcbiAgICAjIFN0YXJ0IHRoZSBkcmFnIHN0YXRlc1xuICAgIEBfaW5pdERyYWcoKVxuICAgIHJldHVyblxuXG4gIFxuICAjIyMqXG4gIENhbGxlZCB0byB0ZWxsIHRoZSBsaXN0IHRvIHN0b3AgcmVmcmVzaGluZy4gVGhpcyBpcyB1c2VmdWxcbiAgaWYgeW91IGFyZSByZWZyZXNoaW5nIHRoZSBsaXN0IGFuZCBhcmUgZG9uZSB3aXRoIHJlZnJlc2hpbmcuXG4gICMjI1xuICBzdG9wUmVmcmVzaGluZzogLT5cbiAgICByZWZyZXNoZXIgPSBAZWwucXVlcnlTZWxlY3RvcihcIi5saXN0LXJlZnJlc2hlclwiKVxuICAgIHJlZnJlc2hlci5zdHlsZS5oZWlnaHQgPSBcIjBweFwiXG4gICAgcmV0dXJuXG5cbiAgXG4gICMjIypcbiAgSWYgd2Ugc2Nyb2xsZWQgYW5kIGhhdmUgdmlydHVhbCBtb2RlIGVuYWJsZWQsIGNvbXB1dGUgdGhlIHdpbmRvd1xuICBvZiBhY3RpdmUgZWxlbWVudHMgaW4gb3JkZXIgdG8gZmlndXJlIG91dCB0aGUgdmlld3BvcnQgdG8gcmVuZGVyLlxuICAjIyNcbiAgZGlkU2Nyb2xsOiAoZSkgLT5cbiAgICBpZiBAaXNWaXJ0dWFsXG4gICAgICBpdGVtSGVpZ2h0ID0gQGl0ZW1IZWlnaHRcbiAgICAgIFxuICAgICAgIyBUT0RPOiBUaGlzIHdvdWxkIGJlIGluYWNjdXJhdGUgaWYgd2UgYXJlIHdpbmRvd2VkXG4gICAgICB0b3RhbEl0ZW1zID0gQGxpc3RFbC5jaGlsZHJlbi5sZW5ndGhcbiAgICAgIFxuICAgICAgIyBHcmFiIHRoZSB0b3RhbCBoZWlnaHQgb2YgdGhlIGxpc3RcbiAgICAgIHNjcm9sbEhlaWdodCA9IGUudGFyZ2V0LnNjcm9sbEhlaWdodFxuICAgICAgXG4gICAgICAjIEdldCB0aGUgdmlld3BvcnQgaGVpZ2h0XG4gICAgICB2aWV3cG9ydEhlaWdodCA9IEBlbC5wYXJlbnROb2RlLm9mZnNldEhlaWdodFxuICAgICAgXG4gICAgICAjIHNjcm9sbFRvcCBpcyB0aGUgY3VycmVudCBzY3JvbGwgcG9zaXRpb25cbiAgICAgIHNjcm9sbFRvcCA9IGUuc2Nyb2xsVG9wXG4gICAgICBcbiAgICAgICMgSGlnaCB3YXRlciBpcyB0aGUgcGl4ZWwgcG9zaXRpb24gb2YgdGhlIGZpcnN0IGVsZW1lbnQgdG8gaW5jbHVkZSAoZXZlcnl0aGluZyBiZWZvcmVcbiAgICAgICMgdGhhdCB3aWxsIGJlIHJlbW92ZWQpXG4gICAgICBoaWdoV2F0ZXIgPSBNYXRoLm1heCgwLCBlLnNjcm9sbFRvcCArIEB2aXJ0dWFsUmVtb3ZlVGhyZXNob2xkKVxuICAgICAgXG4gICAgICAjIExvdyB3YXRlciBpcyB0aGUgcGl4ZWwgcG9zaXRpb24gb2YgdGhlIGxhc3QgZWxlbWVudCB0byBpbmNsdWRlIChldmVyeXRoaW5nIGFmdGVyXG4gICAgICAjIHRoYXQgd2lsbCBiZSByZW1vdmVkKVxuICAgICAgbG93V2F0ZXIgPSBNYXRoLm1pbihzY3JvbGxIZWlnaHQsIE1hdGguYWJzKGUuc2Nyb2xsVG9wKSArIHZpZXdwb3J0SGVpZ2h0ICsgQHZpcnR1YWxBZGRUaHJlc2hvbGQpXG4gICAgICBcbiAgICAgICMgQ29tcHV0ZSBob3cgbWFueSBpdGVtcyBwZXIgdmlld3BvcnQgc2l6ZSBjYW4gc2hvd1xuICAgICAgaXRlbXNQZXJWaWV3cG9ydCA9IE1hdGguZmxvb3IoKGxvd1dhdGVyIC0gaGlnaFdhdGVyKSAvIGl0ZW1IZWlnaHQpXG4gICAgICBcbiAgICAgICMgR2V0IHRoZSBmaXJzdCBhbmQgbGFzdCBlbGVtZW50cyBpbiB0aGUgbGlzdCBiYXNlZCBvbiBob3cgbWFueSBjYW4gZml0XG4gICAgICAjIGJldHdlZW4gdGhlIHBpeGVsIHJhbmdlIG9mIGxvd1dhdGVyIGFuZCBoaWdoV2F0ZXJcbiAgICAgIGZpcnN0ID0gcGFyc2VJbnQoTWF0aC5hYnMoaGlnaFdhdGVyIC8gaXRlbUhlaWdodCksIDEwKVxuICAgICAgbGFzdCA9IHBhcnNlSW50KE1hdGguYWJzKGxvd1dhdGVyIC8gaXRlbUhlaWdodCksIDEwKVxuICAgICAgXG4gICAgICAjIEdldCB0aGUgaXRlbXMgd2UgbmVlZCB0byByZW1vdmVcbiAgICAgIEBfdmlydHVhbEl0ZW1zVG9SZW1vdmUgPSBBcnJheTo6c2xpY2UuY2FsbChAbGlzdEVsLmNoaWxkcmVuLCAwLCBmaXJzdClcbiAgICAgIFxuICAgICAgIyBHcmFiIHRoZSBub2RlcyB3ZSB3aWxsIGJlIHNob3dpbmdcbiAgICAgIG5vZGVzID0gQXJyYXk6OnNsaWNlLmNhbGwoQGxpc3RFbC5jaGlsZHJlbiwgZmlyc3QsIGZpcnN0ICsgaXRlbXNQZXJWaWV3cG9ydClcbiAgICAgIEByZW5kZXJWaWV3cG9ydCBhbmQgQHJlbmRlclZpZXdwb3J0KGhpZ2hXYXRlciwgbG93V2F0ZXIsIGZpcnN0LCBsYXN0KVxuICAgIHJldHVyblxuXG4gIGRpZFN0b3BTY3JvbGxpbmc6IChlKSAtPlxuICAgIGlmIEBpc1ZpcnR1YWxcbiAgICAgIGkgPSAwXG5cbiAgICAgIHdoaWxlIGkgPCBAX3ZpcnR1YWxJdGVtc1RvUmVtb3ZlLmxlbmd0aFxuICAgICAgICBlbCA9IEBfdmlydHVhbEl0ZW1zVG9SZW1vdmVbaV1cbiAgICAgICAgXG4gICAgICAgICNlbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsKTtcbiAgICAgICAgQGRpZEhpZGVJdGVtIGFuZCBAZGlkSGlkZUl0ZW0oaSlcbiAgICAgICAgaSsrXG4gICAgcmV0dXJuXG5cbiAgXG4gICMgT25jZSBzY3JvbGxpbmcgc3RvcHMsIGNoZWNrIGlmIHdlIG5lZWQgdG8gcmVtb3ZlIG9sZCBpdGVtc1xuICBcbiAgIyMjKlxuICBDbGVhciBhbnkgYWN0aXZlIGRyYWcgZWZmZWN0cyBvbiB0aGUgbGlzdC5cbiAgIyMjXG4gIGNsZWFyRHJhZ0VmZmVjdHM6IC0+XG4gICAgaWYgQF9sYXN0RHJhZ09wXG4gICAgICBAX2xhc3REcmFnT3AuY2xlYW4gYW5kIEBfbGFzdERyYWdPcC5jbGVhbigpXG4gICAgICBAX2xhc3REcmFnT3AgPSBudWxsXG4gICAgcmV0dXJuXG5cbiAgX2luaXREcmFnOiAtPlxuICAgIFxuICAgICNpb25pYy52aWV3cy5MaXN0Vmlldy5fX3N1cGVyX18uX2luaXREcmFnLmNhbGwodGhpcyk7XG4gICAgXG4gICAgIyBTdG9yZSB0aGUgbGFzdCBvbmVcbiAgICBAX2xhc3REcmFnT3AgPSBAX2RyYWdPcFxuICAgIEBfZHJhZ09wID0gbnVsbFxuICAgIHJldHVyblxuXG4gIFxuICAjIFJldHVybiB0aGUgbGlzdCBpdGVtIGZyb20gdGhlIGdpdmVuIHRhcmdldFxuICBfZ2V0SXRlbTogKHRhcmdldCkgLT5cbiAgICB3aGlsZSB0YXJnZXRcbiAgICAgIHJldHVybiB0YXJnZXQgIGlmIHRhcmdldC5jbGFzc0xpc3QgYW5kIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoSVRFTV9DTEFTUylcbiAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlXG4gICAgbnVsbFxuXG4gIF9zdGFydERyYWc6IChlKSAtPlxuICAgIF90aGlzID0gdGhpc1xuICAgIGRpZFN0YXJ0ID0gZmFsc2VcbiAgICBAX2lzRHJhZ2dpbmcgPSBmYWxzZVxuICAgIGxhc3REcmFnT3AgPSBAX2xhc3REcmFnT3BcbiAgICBpdGVtID0gdW5kZWZpbmVkXG4gICAgXG4gICAgIyBDaGVjayBpZiB0aGlzIGlzIGEgcmVvcmRlciBkcmFnXG4gICAgaWYgaW9uaWMuRG9tVXRpbC5nZXRQYXJlbnRPclNlbGZXaXRoQ2xhc3MoZS50YXJnZXQsIElURU1fUkVPUkRFUl9CVE5fQ0xBU1MpIGFuZCAoZS5nZXN0dXJlLmRpcmVjdGlvbiBpcyBcInVwXCIgb3IgZS5nZXN0dXJlLmRpcmVjdGlvbiBpcyBcImRvd25cIilcbiAgICAgIGl0ZW0gPSBAX2dldEl0ZW0oZS50YXJnZXQpXG4gICAgICBpZiBpdGVtXG4gICAgICAgIEBfZHJhZ09wID0gbmV3IFJlb3JkZXJEcmFnKFxuICAgICAgICAgIGxpc3RFbDogQGVsXG4gICAgICAgICAgZWw6IGl0ZW1cbiAgICAgICAgICBzY3JvbGxFbDogQHNjcm9sbEVsXG4gICAgICAgICAgc2Nyb2xsVmlldzogQHNjcm9sbFZpZXdcbiAgICAgICAgICBvblJlb3JkZXI6IChlbCwgc3RhcnQsIGVuZCkgLT5cbiAgICAgICAgICAgIF90aGlzLm9uUmVvcmRlciBhbmQgX3RoaXMub25SZW9yZGVyKGVsLCBzdGFydCwgZW5kKVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIClcbiAgICAgICAgQF9kcmFnT3Auc3RhcnQgZVxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICBcbiAgICAjIE9yIGNoZWNrIGlmIHRoaXMgaXMgYSBzd2lwZSB0byB0aGUgc2lkZSBkcmFnXG4gICAgZWxzZSBpZiBub3QgQF9kaWREcmFnVXBPckRvd24gYW5kIChlLmdlc3R1cmUuZGlyZWN0aW9uIGlzIFwibGVmdFwiIG9yIGUuZ2VzdHVyZS5kaXJlY3Rpb24gaXMgXCJyaWdodFwiKSBhbmQgTWF0aC5hYnMoZS5nZXN0dXJlLmRlbHRhWCkgPiA1XG4gICAgICBcbiAgICAgICMgTWFrZSBzdXJlIHRoaXMgaXMgYW4gaXRlbSB3aXRoIGJ1dHRvbnNcbiAgICAgIGl0ZW0gPSBAX2dldEl0ZW0oZS50YXJnZXQpXG4gICAgICBpZiBpdGVtIGFuZCBpdGVtLnF1ZXJ5U2VsZWN0b3IoXCIuaXRlbS1vcHRpb25zXCIpXG4gICAgICAgIEBfZHJhZ09wID0gbmV3IFNsaWRlRHJhZyhcbiAgICAgICAgICBlbDogQGVsXG4gICAgICAgICAgY2FuU3dpcGU6IEBjYW5Td2lwZVxuICAgICAgICApXG4gICAgICAgIEBfZHJhZ09wLnN0YXJ0IGVcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgXG4gICAgIyBJZiB3ZSBoYWQgYSBsYXN0IGRyYWcgb3BlcmF0aW9uIGFuZCB0aGlzIGlzIGEgbmV3IG9uZSBvbiBhIGRpZmZlcmVudCBpdGVtLCBjbGVhbiB0aGF0IGxhc3Qgb25lXG4gICAgbGFzdERyYWdPcC5jbGVhbiBhbmQgbGFzdERyYWdPcC5jbGVhbigpICBpZiBsYXN0RHJhZ09wIGFuZCBAX2RyYWdPcCBhbmQgbm90IEBfZHJhZ09wLmlzU2FtZUl0ZW0obGFzdERyYWdPcCkgYW5kIGUuZGVmYXVsdFByZXZlbnRlZFxuICAgIHJldHVyblxuXG4gIF9oYW5kbGVFbmREcmFnOiAoZSkgLT5cbiAgICBfdGhpcyA9IHRoaXNcbiAgICBAX2RpZERyYWdVcE9yRG93biA9IGZhbHNlXG4gICAgXG4gICAgI2lvbmljLnZpZXdzLkxpc3RWaWV3Ll9fc3VwZXJfXy5faGFuZGxlRW5kRHJhZy5jYWxsKHRoaXMsIGUpO1xuICAgIHJldHVybiAgdW5sZXNzIEBfZHJhZ09wXG4gICAgQF9kcmFnT3AuZW5kIGUsIC0+XG4gICAgICBfdGhpcy5faW5pdERyYWcoKVxuICAgICAgcmV0dXJuXG5cbiAgICByZXR1cm5cblxuICBcbiAgIyMjKlxuICBQcm9jZXNzIHRoZSBkcmFnIGV2ZW50IHRvIG1vdmUgdGhlIGl0ZW0gdG8gdGhlIGxlZnQgb3IgcmlnaHQuXG4gICMjI1xuICBfaGFuZGxlRHJhZzogKGUpIC0+XG4gICAgX3RoaXMgPSB0aGlzXG4gICAgY29udGVudCA9IHVuZGVmaW5lZFxuICAgIGJ1dHRvbnMgPSB1bmRlZmluZWRcbiAgICBAX2RpZERyYWdVcE9yRG93biA9IHRydWUgIGlmIE1hdGguYWJzKGUuZ2VzdHVyZS5kZWx0YVkpID4gNVxuICAgIFxuICAgICMgSWYgd2UgZ2V0IGEgZHJhZyBldmVudCwgbWFrZSBzdXJlIHdlIGFyZW4ndCBpbiBhbm90aGVyIGRyYWcsIHRoZW4gY2hlY2sgaWYgd2Ugc2hvdWxkXG4gICAgIyBzdGFydCBvbmVcbiAgICBAX3N0YXJ0RHJhZyBlICBpZiBub3QgQGlzRHJhZ2dpbmcgYW5kIG5vdCBAX2RyYWdPcFxuICAgIFxuICAgICMgTm8gZHJhZyBzdGlsbCwgcGFzcyBpdCB1cFxuICAgIFxuICAgICNpb25pYy52aWV3cy5MaXN0Vmlldy5fX3N1cGVyX18uX2hhbmRsZURyYWcuY2FsbCh0aGlzLCBlKTtcbiAgICByZXR1cm4gIHVubGVzcyBAX2RyYWdPcFxuICAgIGUuZ2VzdHVyZS5zcmNFdmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgQF9kcmFnT3AuZHJhZyBlXG4gICAgcmV0dXJuXG4pIiwiYW5ndWxhci5tb2R1bGUoJ2lvbmljLmNvbnRyaWIuVHJlZVZpZXcnKS5kaXJlY3RpdmUgXCJ0cmVlSXRlbVwiLCBbXG4gIFwiJGFuaW1hdGVcIlxuICBcIiRjb21waWxlXCJcbiAgKCRhbmltYXRlLCAkY29tcGlsZSkgLT5cbiAgICByZXR1cm4gKFxuICAgICAgcmVzdHJpY3Q6IFwiRVwiXG4gICAgICBjb250cm9sbGVyOiBbXG4gICAgICAgIFwiJHNjb3BlXCJcbiAgICAgICAgXCIkZWxlbWVudFwiXG4gICAgICAgICgkc2NvcGUsICRlbGVtZW50KSAtPlxuICAgICAgICAgICRzY29wZS50b2dnbGUgPSAoJGV2ZW50LCByb3cpIC0+XG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgICAgIHJvdy5leHBhbmRlZCA9ICFyb3cuZXhwYW5kZWRcbiAgICAgICAgICAgICRzY29wZS5vbkV4cGFuZENoYW5nZSh7IHJvdzogcm93IH0pXG5cbiAgICAgICAgICAkc2NvcGUuY2hlY2tib3hDbGljayA9ICgkZXZlbnQsIHJvdykgLT5cbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICAgICAgcm93LiR0cmVldmlldy5jaGVja2VkID0gIXJvdy4kdHJlZXZpZXcuY2hlY2tlZFxuICAgICAgICAgICAgJHNjb3BlLm9uQ2hlY2tib3hDaGFuZ2UoeyByb3c6IHJvdyB9KVxuXG4gICAgICAgICAgJHNjb3BlLnJvd0NsaWNrID0gKHJvdykgLT5cbiAgICAgICAgICAgICRzY29wZS5vbkNsaWNrKHsgcm93OiByb3cgfSlcbiAgICAgIF1cbiAgICAgIGNvbXBpbGU6ICgkZWxlbWVudCwgJGF0dHJzKSAtPlxuICAgICAgICAkZWxlbWVudC5hZGRDbGFzcyBcIml0ZW0gaXRlbS1jb21wbGV4IHRyZWUtaXRlbVwiXG5cbiAgICAgICAgbGluayA9ICgkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMpIC0+XG4gICAgICAgICAgJHNjb3BlLmdldFRyZWVQYWRkaW5nID0gKHJvdykgLT5cbiAgICAgICAgICAgIHBhZGRpbmcgPSByb3cuJHRyZWV2aWV3LmxldmVsICogMjBcbiAgICAgICAgICAgIHJldHVybiB7ICdwYWRkaW5nLWxlZnQnOiBwYWRkaW5nICsgJ3B4JyB9XG4gICAgICAgICAgXG4gICAgICAgICAgJHNjb3BlLmdldFZpc2liaWxpdHkgPSAocm93KSAtPlxuICAgICAgICAgICAgaWYgcm93LiR0cmVldmlldy5oaWRlRXhwYW5kZXJcbiAgICAgICAgICAgICAgcmV0dXJuICdoaWRkZW4nXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgIGlmIHJvdy5jaGlsZHJlbj8ubGVuZ3RoID4gMFxuICAgICAgICAgICAgICAgICd2aXNpYmxlJ1xuICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgJ2hpZGRlbidcblxuIyAgICAgICAgICBpZiAkc2NvcGUuc2hvd051bWJlcnNcbiMgICAgICAgICAgdHJlZUl0ZW1OdW1iZXJDbGFzcyA9IFwidHJlZS1pdGVtLXdpdGgtbnVtYmVyXCJcbiAgICAgICAgICBudW1iZXIgPSBhbmd1bGFyLmVsZW1lbnQoXCI8c3BhbiBuZy1pZj1cXFwic2hvd051bWJlcnNcXFwiIGNsYXNzPVxcXCJ0cmVlLWl0ZW0tbnVtYmVyXFxcIj57e3Jvdy4kdHJlZXZpZXcubnVtYmVyLmpvaW4oJy4nKX19Ojwvc3Bhbj5cIilcbiMgICAgICAgICAgZWxzZVxuIyAgICAgICAgICAgIHRyZWVJdGVtTnVtYmVyQ2xhc3MgPSBcIlwiXG5cbiMgICAgICAgICAgc2hvd0NoZWNrYm94ID0gJHNjb3BlLnJvdy5zaG93Q2hlY2tib3ggfHwgKCRzY29wZS5zaG93Q2hlY2tib3hlcyAmJiAkc2NvcGUucm93LnNob3dDaGVja2JveCAhPSBmYWxzZSlcbiMgICAgICAgICAgaWYgc2hvd0NoZWNrYm94XG4jICAgICAgICAgICAgdHJlZUl0ZW1DaGVja2JveENsYXNzID0gXCJ0cmVlLWl0ZW0td2l0aC1jaGVja2JveFwiXG4jICAgICAgICAgIGNoZWNrYm94ID0gYW5ndWxhci5lbGVtZW50KFwiPGxhYmVsXG4jICAgICAgICAgICAgbmctaWY9XFxcInJvdy5zaG93Q2hlY2tib3ggfHwgKHNob3dDaGVja2JveGVzICYmIHJvdy5zaG93Q2hlY2tib3ggIT09IGZhbHNlKVxcXCJcbiMgICAgICAgICAgICBjbGFzcz1cXFwiY2hlY2tib3hcXFwiPjxpbnB1dCB0eXBlPVxcXCJjaGVja2JveFxcXCIgbmctY2hlY2tlZD1cXFwicm93Lml0ZW0uZG9uZVxcXCIgXG4jICAgICAgICAgICAgbmctY2xpY2s9XFxcImNoZWNrYm94Q2xpY2soJGV2ZW50LCByb3cpXFxcIj5cbiMgICAgICAgICAgICA8L2xhYmVsPlwiIykgXG4gICAgICAgICAgY2hlY2tib3ggPSBhbmd1bGFyLmVsZW1lbnQoXCI8bGFiZWwgXG4gICAgICAgICAgICAgIG5nLWlmPVxcXCIhKHJvdy4kdHJlZXZpZXcuc2hvd0NoZWNrYm94IHx8IChzaG93Q2hlY2tib3hlcyAmJiByb3cuJHRyZWV2aWV3LnNob3dDaGVja2JveCAhPT0gZmFsc2UpKVxcXCJcbiAgICAgICAgICAgICAgc3R5bGU9XFxcImhlaWdodDogMjhweDsgd2lkdGg6IDFweDsgZmxvYXQ6IGxlZnQ7IHBhZGRpbmctbGVmdDogM3B4O1xcXCI+PC9sYWJlbD5cbiAgICAgICAgICAgICAgPGxhYmVsIG5nLWlmPVxcXCJyb3cuJHRyZWV2aWV3LnNob3dDaGVja2JveCB8fCAoc2hvd0NoZWNrYm94ZXMgJiYgcm93LiR0cmVldmlldy5zaG93Q2hlY2tib3ggIT09IGZhbHNlKVxcXCIgXG4gICAgICAgICAgICAgICAgY2xhc3M9XFxcImNoZWNrYm94XFxcIj48aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIG5nLWNoZWNrZWQ9XFxcInJvdy4kdHJlZXZpZXcuY2hlY2tlZFxcXCIgbmctY2xpY2s9XFxcImNoZWNrYm94Q2xpY2soJGV2ZW50LCByb3cpXFxcIj5cbiAgICAgICAgICAgIDwvbGFiZWw+XCIpXG4jICAgICAgICAgIGVsc2VcbiMgICAgICAgICAgICB0cmVlSXRlbUNoZWNrYm94Q2xhc3MgPSBcIlwiXG5cbiAgICAgICAgICAjIGB0cnVlYCBpbnN0ZWFkIG9mIGByb3cuc2hvd0NoZWNrYm94IHx8IChzaG93Q2hlY2tib3hlcyAmJiByb3cuc2hvd0NoZWNrYm94ICE9PSBmYWxzZSlgXG4gICAgICAgICAgIyBpdCdzIGp1c3QgZGF5cyBiZWZvcmUgcmVsZWFzZSwgQ1NTIGlzIHNldCB0aGlzIHdheSByaWdodCBub3csIC4uLlxuICAgICAgICAgICMgbGV0J3MgbGVhdmUgaXQgYXMgaXQgaXMgZm9yIG5vdy4gVGhlIHByb2JsZW0gaXMgdGhhdCBjbGFzcyB0cmVlLWl0ZW0td2l0aC1jaGVja2JveFxuICAgICAgICAgICMgd2lsbCBiZSB0aGVyZSBldmVuIGZvciBlbGVtZW50cyBXSVRIT1VUIGNoZWNrYm94ZXMgLSBuZWVkcyByZWZhY3RvcmluZ1xuICAgICAgICAgIGNvbnRhaW5lckxpbmsgPSBhbmd1bGFyLmVsZW1lbnQoXCI8YSBcbiAgICAgICAgICAgIGNsYXNzPVxcXCJpdGVtLWNvbnRlbnQgaXRlbS1pY29uLXJpZ2h0XFxcIiBcbiAgICAgICAgICAgIG5nLWNsYXNzPVxcXCJ7J3RyZWUtaXRlbS13aXRoLW51bWJlcic6IHNob3dOdW1iZXJzLCAndHJlZS1pdGVtLXdpdGgtY2hlY2tib3gnOiB0cnVlfVxcXCJcbiAgICAgICAgICAgIG5nLWNsaWNrPVxcXCJyb3dDbGljayhyb3cpXFxcIlxuICAgICAgICAgICAgbmctc3R5bGU9XFxcImdldFRyZWVQYWRkaW5nKHJvdylcXFwiXG4gICAgICAgICAgICA+PC9hPlwiKVxuXG4gICAgICAgICAgY2hldnJvbiA9IGFuZ3VsYXIuZWxlbWVudChcIjxhIGNsYXNzPVxcXCJleHBhbmQtYnV0dG9uIGljb24gaW9uLWNoZXZyb24tZG93blxcXCIgXG4gICAgICAgICAgICBuZy1jbGFzcz1cXFwieyd0cmVlLWl0ZW0tZXhwYW5kZWQnOiByb3cuZXhwYW5kZWR9XFxcIiBcbiAgICAgICAgICAgIG5nLXN0eWxlPVxcXCJ7J3Zpc2liaWxpdHknOiBnZXRWaXNpYmlsaXR5KHJvdyl9XFxcIlxuICAgICAgICAgICAgbmctY2xpY2s9XFxcInRvZ2dsZSgkZXZlbnQsIHJvdylcXFwiPjwvYT5cIilcblxuICAgICAgICAgIHRleHRDb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoXCI8c3BhbiBjbGFzcz1cXFwidHJlZS1pdGVtLXRleHRcXFwiPjwvc3Bhbj5cIilcblxuICAgICAgICAgIHRleHRDb250YWluZXIuYXBwZW5kICRlbGVtZW50LmNvbnRlbnRzKClcblxuIyAgICAgICAgICBpZiAkc2NvcGUuc2hvd051bWJlcnNcbiAgICAgICAgICBjb250YWluZXJMaW5rLmFwcGVuZChudW1iZXIpXG4gICAgICAgICAgXG4gICAgICAgICAgY29udGFpbmVyTGluay5hcHBlbmQoY2hlY2tib3gpXG4gICAgICAgICAgXG4gICAgICAgICAgY29udGFpbmVyTGluay5hcHBlbmQodGV4dENvbnRhaW5lcikuYXBwZW5kKGNoZXZyb24pXG5cbiAgICAgICAgICAkZWxlbWVudC5hcHBlbmQgY29udGFpbmVyTGlua1xuICAgICAgICAgICRjb21waWxlKGNvbnRhaW5lckxpbmspKCRzY29wZSlcblxuICAgICAgICAgIHJldHVyblxuXG4gICAgICAgIHJldHVybiBsaW5rXG4gICAgKVxuXSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==